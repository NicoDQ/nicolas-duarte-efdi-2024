---
hide:
    - toc
---

# Proyecto Final: WHTMet - Estación Meteorológica IoT

# Diseño y Prototipado

En la fase de diseño y prototipado de WHTMet, el enfoque estuvo centrado en crear una estructura física funcional y accesible, adaptada tanto a los requisitos técnicos del sistema como a las necesidades de los usuarios finales. El diseño de cada componente y circuito del sistema fue un proceso iterativo que comenzó con bocetos a mano, donde conceptualicé la disposición general y la interacción entre los diferentes elementos, tomando en cuenta tanto la facilidad de ensamblaje como la seguridad del kit. La idea era que los componentes fueran intuitivos y fáciles de manejar para usuarios con diferentes niveles de experiencia, como los productores rurales y gestores forestales.

Adjunto por aquí debajo los primeros bocetos y las ideas tomadas al inicio del proyecto:

<figure markdown="span">
  ![Imagen 1 - Diseño y Prototipado - Bocetos Iniciales](../images/PF2/bocetosIniciales/1.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 2 - Diseño y Prototipado - Bocetos Iniciales](../images/PF2/bocetosIniciales/2.jpeg#whtmet-imgGen) 
</figure>

Una vez que los bocetos iniciales estuvieron listos, pasé a trabajar en modelos 3D utilizando programas de CAD (particularmente Fusion 360), lo que permitió crear representaciones digitales más precisas y detalladas de cada pieza del sistema. Estos modelos no sólo ayudaron a visualizar el producto final, sino que también facilitaron la verificación de las dimensiones y la integración de los componentes, garantizando que todo encajara correctamente y que no hubiera interferencias entre los circuitos y las estructuras físicas. Ya que a medida que realizaba los modelos, los iba imprimiendo para tenerlos fisicamente e ir prototipando:


##  Diseño y Prototipado - Caja/Carcasa - Imágenes

<figure markdown="span">
  ![Imagen 1 - Diseño y Prototipado - F360](../images/PF2/f360/1.png#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 5 - Diseño y Prototipado - F360](../images/PF2/f360/5.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 2 - Diseño y Prototipado - F360](../images/PF2/f360/2.png#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 3 - Diseño y Prototipado - F360](../images/PF2/f360/3.png#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 4 - Diseño y Prototipado - F360](../images/PF2/f360/4.png#whtmet-imgGen) 
</figure>

Como se observa, se pasó por 3 versiones distintas de la caja de circuitos.

<figure markdown="span">
  ![Imagen 1 - Diseño y Prototipado - Prototipado Caja](../images/PF2/prototipadoCaja/1.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 2 - Diseño y Prototipado - Prototipado Caja](../images/PF2/prototipadoCaja/2.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 3 - Diseño y Prototipado - Prototipado Caja](../images/PF2/prototipadoCaja/3.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 4 - Diseño y Prototipado - Prototipado Caja](../images/PF2/prototipadoCaja/4.jpeg#whtmet-imgGen) 
</figure>

## Diseño y Prototipado - Caja/Carcasa - Timelapses

### Timelapse Caja


<video width="600"   controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/tlCaja.mp4" type="video/mp4">
</video>


### Timelapse Tapa de Caja


<video width="600"   controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/tlTapa.mp4" type="video/mp4">
</video>


### Timelapse Cobertor


<video width="600"   controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/tlTapa.mp4" type="video/mp4">
</video>


### Timelapse Apliques MQTT y WiFi


<video width="600"   controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/tlApliquesMQTTyWiFi.mp4" type="video/mp4">
</video>


### Timelapse Apliques MQTT y InfluxDB


<video width="600"   controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/tlApliquesMQTTyInfluxDB.mp4" type="video/mp4">
</video>

El diseño de los circuitos fue clave en este proceso, ya que los dispositivos debían ser fáciles de ensamblar y operar. La elección de componentes como el ESP32, junto con sensores de bajo costo, permitió crear un sistema modular y escalable, que podría ser ensamblado sin complicaciones.

## Diseño y Prototipado - Circuitos

<figure markdown="span">
  ![Imagen 1 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/1.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 2 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/2.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 3 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/3.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 4 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/4.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 5 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/5.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 6 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/6.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 7 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/7.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 8 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/8.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 9 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/9.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 10 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/10.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 11 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/11.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 12 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/12.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 13 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/13.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 14 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/14.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 15 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/15.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 16 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/16.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 17 - Diseño y Prototipado - Prototipado Circuitos](../images/PF2/prototipadoCircuito/17.jpeg#whtmet-imgGen) 
</figure>

##  Diseño y Prototipado - Anemómetro

<figure markdown="span">
  ![Imagen 1 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/1.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 2 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/2.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 3 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/3.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 4 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/4.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 5 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/5.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 6 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/6.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 7 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/7.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 8 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/8.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 9 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/9.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 10 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/10.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 11 - Diseño y Prototipado - Prototipado Anemómetro](../images/PF2/prototipadoAnemometro/11.jpeg#whtmet-imgGen) 
</figure>

##  Diseño y Prototipado - Pruebas de Medición

Para aproximar el resultado de medición del viento, cargue el equipo en el auto y conecte todo con la ayuda de unos amigos, poniendo el vehiculo a 30 km/m por la computadora (Velocidad Crucero) e ir tomando las medidas del anemómetro intentando llevar el valor del anemómetro, a la velocidad que marca el auto, luego de unos 40km de ir en tandas de 5km, corrigiendo el factor, llegué a un factor de 2.61 que es el mejor aproximado que conseguí en base a la prueba realizada, obviamente si bien esta prueba es bastante empírica, no es un resultado 100% fiable, debido a que para poder tener mediciones exactas por los diferentes factores que pueden incidir en ella, para tener resultados aún mas certeros habría que comparar y medir contra un anemómetro comercial, de manera de llevar al mínimo las correciones en las medidas.

Aquí debajo dejo algunas fotos y videos del proceso:

<figure markdown="span">
  ![Imagen 1 - Diseño y Prototipado - Pruebas de Medición](../images/PF2/prototipadoAnemometro/12.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 2 - Diseño y Prototipado - Pruebas de Medición](../images/PF2/prototipadoAnemometro/13.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 3 - Diseño y Prototipado - Pruebas de Medición](../images/PF2/prototipadoAnemometro/14.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 4 - Diseño y Prototipado - Pruebas de Medición](../images/PF2/prototipadoAnemometro/15.jpeg#whtmet-imgGen) 
</figure>

<figure markdown="span">
  ![Imagen 5 - Diseño y Prototipado - Pruebas de Medición](../images/PF2/prototipadoAnemometro/16.jpeg#whtmet-imgGen) 
</figure>

<video width="600"  controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;" style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/medAnem-1.mp4" type="video/mp4">
</video>

<video width="600"  controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;" style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/medAnem-2.mp4" type="video/mp4">
</video>


##  Diseño y Prototipado - Anemómetro - Timelapses

### Timelapse Cuerpo 


<video width="600"   controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/tlCuerpoAnem.mp4" type="video/mp4">
</video>


### Timelapse Eje


<video width="600"   controls style="display: block; margin: 0 auto; border-radius: 5%; padding: 5px;">
  <source src="../../videos/tlEjeAnem.mp4" type="video/mp4">
</video>

El prototipado de los distintos componentes se realizó a través de impresión 3D como ya fue visto en los anteriores timelapses, esto me permitió iterar rápidamente en los diseños, hacer ajustes en tiempo real y probar diferentes configuraciones antes de pasar a la fase de producción. Este enfoque brinda justamente esa flexibilidad, me garantizó que cada iteración del prototipo fuera más eficiente y funcional, acercándome cada vez más a una solución que pudiera ser implementada y utilizada de manera práctica y económica por los futuros usuarios.

El diseño y prototipado de WHTMet no sólo consideró los aspectos técnicos y funcionales del sistema, sino que también priorizó la capacidad de adaptación, permitiendo que fuera una herramienta útil y práctica.

## Prototipo

El prototipo de WHTMet integra una serie de tecnologías y componentes que permiten un monitoreo climático efectivo en plantaciones de eucalipto. A continuación un breve detalle de los sensores, el sistema de gestión de datos, y el diseño e integración que conforman el prototipo.

### Sensores

El prototipo utiliza varios sensores específicos para medir las variables climáticas en tiempo real:

- **Sensor SHT31 (IP68):** Este sensor se utiliza para medir la temperatura y humedad ambiental. Con su clasificación IP68, es adecuado para soportar condiciones exteriores y protegidas contra el polvo y la humedad, lo que lo hace ideal para plantaciones en entornos rurales. Su alta precisión asegura mediciones confiables para la gestión de recursos en las plantaciones.

- **Sensor DHT11:** Este sensor se encarga de medir la temperatura y humedad dentro de la caja de circuitos. Al ser un sensor más económico y de menor precisión en comparación con el SHT31, se utiliza para garantizar el funcionamiento óptimo del sistema dentro de un entorno controlado, como lo es la caja que alberga los circuitos y la electrónica.

- **Sensor Hall (Anemómetro):** Este sensor se utiliza para medir la velocidad del viento, lo cual es crucial para entender cómo las condiciones climáticas afectan las plantaciones, especialmente en áreas con fuertes vientos que pueden impactar el crecimiento de los cultivos. El diseño del anemómetro aún está en proceso de adaptación para mejorar su precisión y robustez en condiciones de exterior.

### Sistema de Gestión de Datos

El prototipo hace uso de varias tecnologías de software y bases de datos para procesar, almacenar y visualizar los datos en tiempo real:

- **Proxmox:** La plataforma de virtualización Proxmox se utiliza para gestionar de manera centralizada el servidor y los servicios necesarios para WHTMet. Esta infraestructura virtualizada permite manejar eficientemente los recursos y el procesamiento de datos provenientes de los sensores distribuidos dentro de los nodos en las plantaciones.

- **Node-RED:** La plataforma de Node-RED se encarga de gestionar los flujos de datos desde los sensores de cada nodo. A través de un diseño visual y fácil de integrar, los datos recolectados por los sensores son procesados y enviados a la base de datos en tiempo real (InfluxDB). Además, Node-RED facilita la creación de flujos automatizados, como alertas o acciones específicas basadas en los valores medidos, de los cuales para este prototipo, se incluyen: alerta por vientos fuertes, alerta por alta o baja temperatura (tanto exterior como interior), así como alerta de alta o baja humedad (tanto exterior como interior), estas anteriores alertas tanto funcionan en el mismo dashboard de Node-RE, así como por envío de mensajes a través de WhatsApp (usando CallMeBot).

- **Mosquitto MQTT:** Se emplea Mosquitto MQTT como protocolo de mensajería para transmitir datos de manera eficiente entre los sensores y el sistema central. MQTT es especialmente útil en entornos de baja ancho de banda o donde se requieren actualizaciones frecuentes y en tiempo real.

- **InfluxDB:** InfluxDB, una base de datos especializada en time series (TSDB), es utilizada para almacenar las mediciones de los sensores a lo largo del tiempo. Esta base de datos permite una gestión eficiente de grandes volúmenes de datos temporales, asegurando un acceso rápido y preciso para su análisis posterior.

- **PostgreSQL:** Los datos tomados se migran de InfluxDB a PostgreSQL. Esta base de datos relacional permite manejar de manera eficiente la información recabada por los sensores y mantener un respaldo histórico de ello.

### Interfaz de Usuario

La interfaz de usuario se ha diseñado para proporcionar una experiencia intuitiva a los usuarios del sistema. En su estado actual, la interfaz incluye un mapa interactivo que se alimenta a través de la API de Google Maps, mostrando la ubicación georreferenciada de los nodos de sensores. Aunque por el momento sólo hay un nodo activo, el diseño de la interfaz permite la fácil expansión del sistema para incluir más nodos a medida que se incorporen más puntos de monitoreo en la plantación.

### Diseño e Integración

El diseño físico del prototipo ha sido cuidadosamente planificado para garantizar que los sensores y la electrónica puedan operar eficientemente en condiciones exteriores y rurales:

- **Diseño 2D/3D:** Se ha diseñado una caja y tapa protectora personalizada para los sensores y la electrónica, con un enfoque en la resistencia a condiciones adversas. Este diseño asegura que los componentes del sistema estén protegidos de factores como la lluvia, el polvo y las temperaturas extremas, comunes en las plantaciones de eucalipto. Esto está sujeto al uso de materiales más resistentes como ABS.

- **Adaptación del Diseño del Anemómetro:** El diseño del anemómetro está en proceso de adaptación para optimizar su rendimiento en entornos exteriores. Esta fase incluye la mejora de la precisión y la durabilidad del sensor frente a condiciones de viento extremas.

- **Procesos Aditivos/Sustractivos:** Para la creación de los prototipos, se ha utilizado la impresión 3D en PLA (para las primeras pruebas) y ABS (para el producto final), materiales adecuados para crear cajas resistentes y duraderas. La impresión 3D ha permitido una personalización rápida del diseño y la fabricación de piezas de manera eficiente.

### Electrónica y Programación

El prototipo utiliza el ESP32, un microcontrolador eficiente que permite la conexión de los sensores al sistema de gestión central. La programación se realiza mediante el Arduino IDE, y los flujos automatizados en Node-RED facilitan la integración de todos los componentes. A través de MQTT Mosquitto, los datos se envían de manera eficiente a las bases de datos, y InfluxDB y PostgreSQL permiten almacenar y gestionar los datos a largo plazo. Además, los procesos de migración de datos de InfluxDB a PostgreSQL se gestionan mediante tareas automatizadas.